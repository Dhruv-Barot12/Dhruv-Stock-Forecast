    async function getSupportResistance() {
      document.getElementById('report-output').innerHTML = '<p>Loading...</p>';
      try {
        const res = await fetch('/support-resistance');
        const data = await res.json();
        if (data.error) throw new Error(data.error);
        document.getElementById('report-output').innerHTML = `
          <h3>Current Nifty Levels</h3>
          <p><strong>Spot:</strong> ${data.spot}</p>
          <p><strong>Support:</strong> ${data.support}</p>
          <p><strong>Resistance:</strong> ${data.resistance}</p>
          <p><em>${data.logic}</em></p>
        `;
      } catch (err) {
        document.getElementById('report-output').innerHTML = `<p style="color:red;">Error: ${err.message}</p>`;
      }
    }

    async function generateReport() {
      document.getElementById('report-output').innerHTML = '<h3>Generating report... (10-20s)</h3>';
      try {
        const res = await fetch('/generate-report');
        const result = await res.json();
        if (!result.success) throw new Error(result.error || "Failed");
        document.getElementById('report-output').innerHTML = `
          <h3>AI Report</h3>
          <p><strong>Spot:</strong> ${result.spot} | <strong>ATM:</strong> ${result.atm_strike}</p>
          <hr>
          <div style="white-space: pre-wrap;">${result.report.replace(/\n/g, '<br>')}</div>
          <p><small>Generated: ${result.generated_at}</small></p>
        `;
      } catch (err) {
        document.getElementById('report-output').innerHTML = `<p style="color:red;">Error: ${err.message}</p>`;
      }
    }
